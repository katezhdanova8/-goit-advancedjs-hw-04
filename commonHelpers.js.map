{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nconst API_KEY = '8362380-caaef8a54ecf306e81d153d22';\nconst BASE_URL = 'https://pixabay.com/api/';\nexport const PER_PAGE = 15;\n\nexport const fetchPhotos = async (query, page) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: PER_PAGE,\n    page: page,\n  });\n\n  return await axios.get(\n    `${BASE_URL}?${searchParams}`\n  );\n};","export const galleryMarkup = data => {\n  return data\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) => {\n        return `\n            <li>\n                <a href=\"${largeImageURL}\">\n                    <img class=\"gallery__image\" src=\"${webformatURL}\" alt=\"${tags}\" />\n                </a>\n                <div class=\"gallery__info\">\n                    <div class=\"gallery__likes gallery__info__item\">\n                        <p class=\"fas fa-heart\">Likes</p>\n                        <span>${likes}</span>\n                    </div>\n                    <div class=\"gallery__views gallery__info__item\">\n                        <p class=\"fas fa-eye\">Views</p>\n                        <span>${views}</span>\n                    </div>\n                    <div class=\"gallery__comments gallery__info__item\">\n                        <p class=\"fas fa-comment\">Comments</p>\n                        <span>${comments}</span>\n                    </div>\n                    <div class=\"gallery__downloads gallery__info__item\">\n                        <p class=\"fas fa-download\">Downloads</p>\n                        <span>${downloads}</span>\n                    </div>\n                </div>\n            </li>\n        `;\n      }\n    )\n    .join('');\n};","import SimpleLightbox from 'simplelightbox';\nimport iziToast from 'izitoast';\nimport { fetchPhotos, PER_PAGE } from './js/pixabay-api';\nimport { galleryMarkup } from './js/render-functions';\n\nconst searchForm = document.querySelector('.form');\nconst gallery = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more-btn');\n\nlet currentPage = 1;\nlet searchValue = '';\n\nconst showError = (message) => {\n  iziToast.error({\n    title: 'Error',\n    message: message,\n    position: 'topRight',\n  });\n};\n\nconst showInfo = (message) => {\n  iziToast.info({\n    title: 'Info',\n    message: message,\n    position: 'topRight',\n  });\n};\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nsearchForm.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', onLoadMoreClick);\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n\n  searchValue = event.currentTarget.elements.user_query.value.trim();\n\n  if (searchValue === '') {\n    showError('Please enter something to search.');\n    searchForm.reset();\n    return;\n  }\n\n  gallery.innerHTML = '';\n  currentPage = 1;\n\n  loader.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const { data } = await fetchPhotos(searchValue, currentPage);\n    const { hits, totalHits } = data;\n\n    if (hits.length === 0) {\n      showError('Sorry, there are no images matching your search query. Please try again!');\n      return;\n    }\n\n    gallery.innerHTML = galleryMarkup(hits);\n    lightbox.refresh();\n\n    if (hits.length < PER_PAGE || hits.length >= totalHits) {\n      showInfo('We\\'re sorry, but you\\'ve reached the end of search results.');\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n  } catch (error) {\n    showError('Failed to load images.');\n  } finally {\n    loader.classList.add('is-hidden');\n    searchForm.reset();\n  }\n}\n\nasync function onLoadMoreClick() {\n  currentPage += 1;\n  loader.classList.remove('is-hidden');\n  loadMoreBtn.classList.add('is-hidden');\n\n  try {\n    const { data } = await fetchPhotos(searchValue, currentPage);\n    const { hits, totalHits } = data;\n\n    gallery.insertAdjacentHTML('beforeend', galleryMarkup(hits));\n    lightbox.refresh();\n\n    if (currentPage * PER_PAGE >= totalHits) {\n      showInfo('We\\'re sorry, but you\\'ve reached the end of search results.');\n    } else {\n      loadMoreBtn.classList.remove('is-hidden');\n    }\n\n    scrollToNewImages();\n  } catch (error) {\n    showError('Failed to load images.');\n  } finally {\n    loader.classList.add('is-hidden');\n  }\n}\n\nfunction scrollToNewImages() {\n  const { height: cardHeight } = gallery.firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n"],"names":["API_KEY","BASE_URL","PER_PAGE","fetchPhotos","query","page","searchParams","axios","galleryMarkup","data","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","gallery","loader","loadMoreBtn","currentPage","searchValue","showError","message","iziToast","showInfo","lightbox","SimpleLightbox","onSearchFormSubmit","onLoadMoreClick","event","hits","totalHits","scrollToNewImages","cardHeight"],"mappings":"owBAEA,MAAMA,EAAU,oCACVC,EAAW,2BACJC,EAAW,GAEXC,EAAc,MAAOC,EAAOC,IAAS,CAChD,MAAMC,EAAe,IAAI,gBAAgB,CACvC,IAAKN,EACL,EAAGI,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,SAAUF,EACV,KAAMG,CACV,CAAG,EAED,OAAO,MAAME,EAAM,IACjB,GAAGN,CAAQ,IAAIK,CAAY,EAC/B,CACA,ECpBaE,EAAgBC,GACpBA,EACJ,IACC,CAAC,CACC,aAAAC,EACA,cAAAC,EACA,KAAAC,EACA,MAAAC,EACA,MAAAC,EACA,SAAAC,EACA,UAAAC,CACR,IACe;AAAA;AAAA,2BAEYL,CAAa;AAAA,uDACeD,CAAY,UAAUE,CAAI;AAAA;AAAA;AAAA;AAAA;AAAA,gCAKjDC,CAAK;AAAA;AAAA;AAAA;AAAA,gCAILC,CAAK;AAAA;AAAA;AAAA;AAAA,gCAILC,CAAQ;AAAA;AAAA;AAAA;AAAA,gCAIRC,CAAS;AAAA;AAAA;AAAA;AAAA,SAMpC,EACA,KAAK,EAAE,EClCNC,EAAa,SAAS,cAAc,OAAO,EAC3CC,EAAU,SAAS,cAAc,UAAU,EAC3CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAc,SAAS,cAAc,gBAAgB,EAE3D,IAAIC,EAAc,EACdC,EAAc,GAElB,MAAMC,EAAaC,GAAY,CAC7BC,EAAS,MAAM,CACb,MAAO,QACP,QAASD,EACT,SAAU,UACd,CAAG,CACH,EAEME,EAAYF,GAAY,CAC5BC,EAAS,KAAK,CACZ,MAAO,OACP,QAASD,EACT,SAAU,UACd,CAAG,CACH,EAEMG,EAAW,IAAIC,EAAe,aAAc,CAChD,aAAc,MACd,aAAc,GAChB,CAAC,EAEDX,EAAW,iBAAiB,SAAUY,CAAkB,EACxDT,EAAY,iBAAiB,QAASU,CAAe,EAErD,eAAeD,EAAmBE,EAAO,CAKvC,GAJAA,EAAM,eAAc,EAEpBT,EAAcS,EAAM,cAAc,SAAS,WAAW,MAAM,OAExDT,IAAgB,GAAI,CACtBC,EAAU,mCAAmC,EAC7CN,EAAW,MAAK,EAChB,MACD,CAEDC,EAAQ,UAAY,GACpBG,EAAc,EAEdF,EAAO,UAAU,OAAO,WAAW,EACnCC,EAAY,UAAU,IAAI,WAAW,EAErC,GAAI,CACF,KAAM,CAAE,KAAAX,CAAI,EAAK,MAAMN,EAAYmB,EAAaD,CAAW,EACrD,CAAE,KAAAW,EAAM,UAAAC,CAAW,EAAGxB,EAE5B,GAAIuB,EAAK,SAAW,EAAG,CACrBT,EAAU,0EAA0E,EACpF,MACD,CAEDL,EAAQ,UAAYV,EAAcwB,CAAI,EACtCL,EAAS,QAAO,EAEZK,EAAK,OAAS9B,GAAY8B,EAAK,QAAUC,EAC3CP,EAAS,4DAA8D,EAEvEN,EAAY,UAAU,OAAO,WAAW,CAE3C,MAAe,CACdG,EAAU,wBAAwB,CACtC,QAAY,CACRJ,EAAO,UAAU,IAAI,WAAW,EAChCF,EAAW,MAAK,CACjB,CACH,CAEA,eAAea,GAAkB,CAC/BT,GAAe,EACfF,EAAO,UAAU,OAAO,WAAW,EACnCC,EAAY,UAAU,IAAI,WAAW,EAErC,GAAI,CACF,KAAM,CAAE,KAAAX,CAAI,EAAK,MAAMN,EAAYmB,EAAaD,CAAW,EACrD,CAAE,KAAAW,EAAM,UAAAC,CAAW,EAAGxB,EAE5BS,EAAQ,mBAAmB,YAAaV,EAAcwB,CAAI,CAAC,EAC3DL,EAAS,QAAO,EAEZN,EAAcnB,GAAY+B,EAC5BP,EAAS,4DAA8D,EAEvEN,EAAY,UAAU,OAAO,WAAW,EAG1Cc,GACD,MAAe,CACdX,EAAU,wBAAwB,CACtC,QAAY,CACRJ,EAAO,UAAU,IAAI,WAAW,CACjC,CACH,CAEA,SAASe,GAAoB,CAC3B,KAAM,CAAE,OAAQC,CAAU,EAAKjB,EAAQ,kBAAkB,wBACzD,OAAO,SAAS,CACd,IAAKiB,EAAa,EAClB,SAAU,QACd,CAAG,CACH"}